<div class="dashboard">
  <div class="dashboard-header">
    <h1>Your Repositories</h1>
    <%= link_to "New Repository", new_repository_path, class: "btn btn-primary" %>
  </div>

  <%= form_with url: repositories_path, method: :get, local: true, class: "search-sort" do |f| %>
    <%= f.text_field :query, value: params[:query], placeholder: "Find a repository...", class: "search-input" %>
    <%= f.select :sort, options_for_select([["Name", "name"], ["Last Updated", "updated"]], params[:sort]), {}, { class: "sort-select", onchange: "this.form.submit()" } %>
    <%= f.submit "Search", class: "btn btn-secondary", style: "display: none;" %>
  <% end %>

  <ul class="repo-list">
    <% @repositories.each do |repo| %>
      <li class="repo-item">
        <div class="repo-info">
          <%= link_to repo.name, repository_pretty_root_path(username: repo.user.username, repository_name: repo.name), class: "repo-name" %>
          <span class="repo-visibility">Public</span>
          <p class="repo-meta">Updated <%= time_ago_in_words(repo.updated_at) %> ago</p>
        </div>
      </li>
    <% end %>
    <% if @repositories.empty? %>
      <li class="empty-state">
        <p>You don't have any repositories yet.</p>
        <%= link_to "Create your first repository", new_repository_path %>
      </li>
    <% end %>
  </ul>
</div>

<style>
  .dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
  .dashboard-header h1 { font-family: var(--font-display); font-size: 2rem; font-weight: 700; margin: 0; }
  
  .search-sort { display: flex; gap: 1rem; margin-bottom: 2rem; }
  .search-input { 
    flex-grow: 1; 
    padding: 10px 16px; 
    background: var(--bg-secondary); 
    border: 1px solid var(--border-color); 
    border-radius: 8px; 
    color: var(--text-primary);
    font-size: 1rem;
  }
  .search-input:focus { border-color: var(--accent-color); outline: none; }
  
  .sort-select { 
    padding: 10px 16px; 
    background: var(--bg-secondary); 
    border: 1px solid var(--border-color); 
    border-radius: 8px; 
    color: var(--text-primary);
  }

  .repo-list { list-style: none; padding: 0; }
  .repo-item { 
    padding: 24px 0; 
    border-bottom: 1px solid var(--border-color); 
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
  }
  .repo-name { font-size: 1.25rem; font-weight: 600; text-decoration: none; color: var(--accent-color); font-family: var(--font-display); }
  .repo-name:hover { color: var(--accent-hover); text-decoration: underline; }
  
  .repo-visibility { font-size: 0.75rem; border: 1px solid var(--border-color); padding: 2px 10px; border-radius: 20px; color: var(--text-secondary); margin-left: 0.75rem; font-weight: 500; }
  .repo-meta { font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.5rem; }
  
  .btn-primary { 
    background: var(--success-color); 
    color: white; 
    text-decoration: none; 
    padding: 10px 20px; 
    border-radius: 8px; 
    font-weight: 600; 
    display: inline-block; 
  }
  .btn-primary:hover { opacity: 0.9; }

  .empty-state { text-align: center; padding: 4rem; color: var(--text-secondary); border: 1px dashed var(--border-color); border-radius: 12px; }
  .empty-state a { color: var(--accent-color); text-decoration: none; font-weight: 600; }
</style>
