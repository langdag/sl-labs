<div class="repository-show">
  <div class="repo-header">
    <div class="repo-title">
      <%= link_to @repository.user.username || @repository.user.email_address.split('@').first, 
                  user_profile_path(@repository.user.username || @repository.user.email_address.split('@').first), 
                  class: "repo-owner" %>
      <span class="separator">/</span>
      <span class="repo-name-link"><%= @repository.name %></span>
      <span class="repo-visibility">Public</span>
    </div>
    <div class="repo-actions">
      <%= link_to "Settings", edit_repository_pretty_path(username: @repository.user.username, repository_name: @repository.name), class: "btn btn-secondary" %>
    </div>
  </div>

  <nav class="repo-tabs">
    <%= link_to "Code", repository_tree_path(username: @repository.user.username, repository_name: @repository.name, ref: @ref, path: nil), class: "tab active" %>
    <%= link_to "Issues", "#", class: "tab" %>
    <%= link_to "Pull requests", "#", class: "tab" %>
    <%= link_to "Actions", "#", class: "tab" %>
    <%= link_to "Settings", edit_repository_pretty_path(username: @repository.user.username, repository_name: @repository.name), class: "tab" %>
  </nav>

  <div class="repo-content">
    <% if @entries.any? %>
      <div class="file-browser">
        <div class="file-list">
          <% @entries.each do |entry| %>
            <div class="file-row">
              <span class="file-name">
                <% full_path = @path.present? ? "#{@path}/#{entry[:name]}" : entry[:name] %>
                <% if entry[:mode] == "40000" %>
                  <%= link_to entry[:name], repository_tree_path(username: @repository.user.username, repository_name: @repository.name, ref: @ref, path: full_path) %>
                <% else %>
                  <%= link_to entry[:name], repository_blob_path(username: @repository.user.username, repository_name: @repository.name, ref: @ref, path: full_path) %>
                <% end %>
              </span>
              <span class="file-type"><%= entry[:mode] == "40000" ? "Directory" : "File" %></span>
            </div>
          <% end %>
        </div>
      </div>
    <% else %>
      <div class="empty-repo">
        <h3>Quick setup — if you’ve done this kind of thing before</h3>
        <div class="setup-commands">
          <pre>git remote add origin <%= request.base_url %>/<%= @repository.user.username || @repository.user.email_address.split('@').first %>/<%= @repository.name %>.git
git branch -M main
git push -u origin main</pre>
        </div>
      </div>
    <% end %>
  </div>
</div>

<style>
  .repo-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem; }
  .repo-title { font-size: 1.25rem; display: flex; align-items: center; gap: 0.25rem; }
  .repo-owner { color: var(--accent-color); text-decoration: none; }
  .repo-owner:hover { text-decoration: underline; }
  .separator { color: var(--text-secondary); }
  .repo-name-link { font-weight: 800; color: var(--accent-hover); }
  .repo-visibility { font-size: 0.75rem; border: 1px solid var(--border-color); padding: 2px 10px; border-radius: 20px; color: var(--text-secondary); margin-left: 0.75rem; font-weight: 500; }

  .repo-tabs { display: flex; border-bottom: 1px solid var(--border-color); margin-bottom: 1.5rem; gap: 1.5rem; }
  .tab { padding: 8px 4px; text-decoration: none; color: var(--text-secondary); border-bottom: 2px solid transparent; font-size: 0.9rem; font-weight: 500; transition: color 0.2s; }
  .tab:hover { color: var(--text-primary); }
  .tab.active { color: var(--text-primary); border-bottom-color: #fd8c73; font-weight: 600; }

  /* File Browser Styling */
  .file-browser { border: 1px solid var(--border-color); border-radius: 6px; overflow: hidden; background: var(--bg-main); }
  .file-list { display: flex; flex-direction: column; }
  .file-row { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    padding: 8px 16px; 
    border-bottom: 1px solid var(--border-color); 
    transition: background 0.1s;
  }
  .file-row:last-child { border-bottom: none; }
  .file-row:hover { background: rgba(139, 148, 158, 0.1); }
  
  .file-name { display: flex; align-items: center; gap: 10px; flex-grow: 1; }
  .file-name a { color: var(--text-primary); text-decoration: none; font-size: 0.9rem; }
  .file-name a:hover { color: var(--accent-color); text-decoration: underline; }
  
  .file-type { font-size: 0.8rem; color: var(--text-secondary); min-width: 80px; text-align: right; }

  .empty-repo { border: 1px solid var(--border-color); border-radius: 6px; padding: 2rem; background: var(--bg-secondary); text-align: center; }
  .empty-repo h3 { margin-top: 0; color: var(--text-primary); }
  .setup-commands pre { background: var(--bg-main); padding: 1.5rem; border-radius: 6px; border: 1px solid var(--border-color); overflow-x: auto; text-align: left; color: #e6edf3; font-size: 0.9rem; }
</style>
